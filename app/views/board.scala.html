@(players: Seq[Player])
@import models._

@moreScripts = {
    <script>
        Spaceships.init(document.getElementById('app'));
    </script>
}

@main("SpaceShip - Board") {
  <div id="app"></div>  
  <div id="players">
    @for(player <- players) {
      @player.name
    }
  </div>
  <input type="text" id="name" />
  <button type="button" id="delete">DELETE</button>
  <button type="button" id="clear">CLEAR ALL</button>
  <canvas id="canvas" width="800" height="600"></canvas>
  <script>
      //setInterval(loop,2000);
      function loop() {
          fetch('/getP', {
              method: 'GET',
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              }
          }).then(function(r) {
              return r.json();
          }).then(function(players) {
              var div = document.getElementById('players');
              div.innerHTML = "";
              players.map(function(player) {
                  div.innerHTML += player.name + " ";
              });
          });
      }
      document.getElementById('delete').addEventListener('click', function(e) {
          var name = document.getElementById('name').value;
          fetch('/dropP/'+name, {
              method: 'POST',
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              body: '{}'
          });
      });
      document.getElementById('clear').addEventListener('click', function(e) {
          fetch('/clear', {
              method: 'POST',
              headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
              },
              body: '{}'
          });
      });
      var source = new EventSource('/source');
      source.onmessage = function(e) {
           var data = e.data;
           console.log(data);
           document.getElementById('app').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
      };

  </script>
}
